name: Auto Update JSON and Images

on:
  push:
    branches:
      - main
  schedule:
    - cron: '0 0 * * *' # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:00 UTC

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: üì• –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
        uses: actions/checkout@v3
        with:
          persist-credentials: false

      - name: üõ†Ô∏è –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        run: npm install axios fs path

      - name: üîÑ –û–±–Ω–æ–≤–ª—è–µ–º JSON –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        run: |
          node update_json.js
          node download_images.js

      - name: üì§ –ö–æ–º–º–∏—Ç–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "GitHub Actions Bot"
          git add recipes_converted.json images/
          git commit -m "üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ JSON –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π" || echo "–ù–µ—á–µ–≥–æ –∫–æ–º–º–∏—Ç–∏—Ç—å"
          git push origin main || echo "–ù–µ—á–µ–≥–æ –ø—É—à–∏—Ç—å"
